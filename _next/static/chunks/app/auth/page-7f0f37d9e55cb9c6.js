(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{4464:(e,o,t)=>{"use strict";t.d(o,{default:()=>E});var n=t(4568),r=t(7620),a=t(1321),s=t(5614),i=t(5187),l=t(8648),c=t(3792);let d={POPUP_FAILED_TO_OPEN:"popup_failed_to_open",POPUP_CLOSED:"popup_closed",ACCESS_DENIED:"access_denied",UNKNOWN:"unknown"};var u=t(7011);let p=e=>{let{onSuccess:o,onError:t,disabled:s}=e,[l,d]=(0,r.useState)(!1),p=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(l&&(e=>"google"in e&&"object"==typeof e.google&&null!=e.google&&"accounts"in e.google&&"object"==typeof e.google.accounts&&null!=e.google.accounts&&"oauth2"in e.google.accounts&&"object"==typeof e.google.accounts.oauth2&&null!=e.google.accounts.oauth2&&"initTokenClient"in e.google.accounts.oauth2)(window))try{var e;p.current=window.google.accounts.oauth2.initTokenClient({client_id:null!=(e=u.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID)?e:"",scope:"https://www.googleapis.com/auth/drive.appdata",callback:e=>{if(e.error){console.error("Google Auth Error:",e),null==t||t(e);return}e.access_token&&o(e.access_token)},error_callback:e=>{console.error("GIS Error:",e),null==t||t(e)}})}catch(e){console.error("Failed to initialize Token Client:",e)}},[l,o,t]),(0,n.jsxs)(a.default,{direction:"row",alignItems:"center",spacing:2,children:[(0,n.jsx)(c.default,{src:"https://accounts.google.com/gsi/client",strategy:"afterInteractive",onLoad:()=>{d(!0)},onError:()=>{console.error("Failed to load Google script")}}),(0,n.jsx)(i.A,{onClick:()=>{let e=p.current;if(!e)return void console.warn("Google Client not initialized");e.requestAccessToken({prompt:"consent"})},disabled:!l||s,variant:"contained",color:"primary",children:l?"Connect Drive":"Loading..."})]})},g={DRIVE_ACCESS_TOKEN:"drive_access_token"},h="app_config.json";class f extends Error{constructor(){super("Google Drive access token expired"),this.name="TokenExpiredError"}}let w=async e=>{let o=await fetch("https://www.googleapis.com/drive/v3/files?q=".concat(encodeURIComponent("name = '".concat(h,"' and 'appDataFolder' in parents and trashed = false")),"&spaces=appDataFolder&fields=files(id, name)"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!o.ok){if(401===o.status)throw new f;throw Error("Error searching for file: ".concat(o.statusText))}let t=await o.json();return(e=>"object"==typeof e&&null!==e&&"files"in e&&Array.isArray(e.files))(t)&&t.files.length>0?t.files[0]:null},m=async(e,o,t)=>{let n="swiftpost_boundary_".concat(Date.now().toString(36)),r=["--".concat(n),"Content-Type: application/json; charset=UTF-8","",JSON.stringify({name:h,mimeType:"application/json",parents:t?void 0:["appDataFolder"]}),"--".concat(n),"Content-Type: application/json","",JSON.stringify(o,null,2),"--".concat(n,"--")].join("\r\n"),a=await fetch(t?"https://www.googleapis.com/upload/drive/v3/files/".concat(t,"?uploadType=multipart"):"https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:t?"PATCH":"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/related; boundary=".concat(n)},body:r});if(!a.ok){if(401===a.status)throw new f;let e=await a.text();throw Error("Failed to save file: ".concat(e))}return(await a.json()).id},x=async(e,o)=>{let t=await fetch("https://www.googleapis.com/drive/v3/files/".concat(o,"?alt=media"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok){if(401===t.status)throw new f;throw Error("Failed to download file: ".concat(t.statusText))}return await t.json()},v={theme:"light",lastActive:Date.now()},y={[d.POPUP_FAILED_TO_OPEN]:"The popup was blocked. Please allow popups for this site.",[d.POPUP_CLOSED]:"Login cancelled.",[d.ACCESS_DENIED]:"Access denied. We need permission to save your data.",[d.UNKNOWN]:"An unknown error occurred."},j=e=>{let{token:o,onLogout:t}=e,{data:l,isLoading:c,isSaving:d,error:u,saveData:p}=((e,o)=>{let[t,n]=(0,r.useState)(null),[a,s]=(0,r.useState)(null),[i,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[u,p]=(0,r.useState)(null),g=(0,r.useRef)(!1),h=(0,r.useCallback)(async()=>{if(e){l(!0),p(null);try{let o=await w(e);if(o){s(o.id);let t=await x(e,o.id);n(t)}else{console.log("No config file found. Creating new one...");let o=await m(e,v);s(o),n(v)}}catch(e){console.error("Sync Init Error:",e),e instanceof f?o():p(e instanceof Error?e.message:"Failed to synchronize data")}finally{l(!1)}}},[e,o]);return(0,r.useEffect)(()=>{!e||g.current||t||(g.current=!0,h())},[e,t,h]),{data:t,isLoading:i,isSaving:c,error:u,saveData:(0,r.useCallback)(async t=>{if(e){n(t),d(!0),p(null);try{await m(e,t,null!=a?a:void 0)}catch(e){console.error("Save Error:",e),e instanceof f?o():p("Failed to save changes")}finally{d(!1)}}},[e,a,o]),refresh:h}})(o,t);return c?(0,n.jsx)(s.A,{children:"Loading configuration from Drive..."}):(0,n.jsxs)(a.default,{spacing:2,padding:2,border:"1px solid #ccc",borderRadius:4,children:[(0,n.jsx)(s.A,{fontSize:20,fontWeight:"bold",children:"Drive Connected âœ…"}),u&&(0,n.jsxs)(s.A,{color:"red",children:["Sync Error: ",u]}),(0,n.jsxs)(a.default,{spacing:1,children:[(0,n.jsx)(s.A,{children:(0,n.jsx)("strong",{children:"Current Data (from Drive):"})}),(0,n.jsx)(s.A,{component:"pre",sx:{background:"#f5f5f5",padding:"10px",borderRadius:"4px"},children:JSON.stringify(l,null,2)})]}),(0,n.jsxs)(a.default,{direction:"row",spacing:2,children:[(0,n.jsx)(i.A,{variant:"contained",onClick:()=>{l&&p({...l,lastActive:Date.now(),theme:"light"===l.theme?"dark":"light"})},disabled:d,children:d?"Saving...":"Update Timestamp & Theme"}),(0,n.jsx)(i.A,{variant:"outlined",onClick:t,color:"error",children:"Disconnect"})]}),d&&(0,n.jsx)(s.A,{fontSize:12,color:"gray",children:"Syncing to Google Drive..."})]})},E=()=>{let[e,o]=(0,r.useState)(),{value:t,setValue:i}=(e=>{let[o,t]=(0,r.useState)((e=>{try{return sessionStorage.getItem(e)}catch(e){return console.error("Error loading from session storage:",e),null}})(e));return(0,r.useEffect)(()=>{let o=o=>{o.key===e&&t(o.newValue)};return window.addEventListener("storage",o),()=>{removeEventListener("storage",o)}},[e]),{value:o,setValue:(0,r.useCallback)(o=>{try{if(null===o){sessionStorage.removeItem(e),t(null);return}sessionStorage.setItem(e,o),t(o)}catch(e){console.error("Error saving to session storage:",e)}},[e])}})(g.DRIVE_ACCESS_TOKEN);return(0,n.jsx)(n.Fragment,{children:null==t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.default,{marginBottom:l.w.spacing(2),children:[(0,n.jsx)(s.A,{children:"You need to allow access to your Google Drive"}),(0,n.jsx)(s.A,{fontSize:l.w.spacing(1.33),children:"This is based on Google's third-party cookies until Google updates it."}),(0,n.jsx)(s.A,{color:"red",children:e})]}),(0,n.jsx)(p,{onSuccess:e=>{i(e),o(void 0)},onError:e=>{if((e=>"object"==typeof e&&null!=e&&"type"in e&&"string"==typeof e.type&&Object.values(d).includes(e.type))(e)){var t;o(null!=(t=e.message)?t:y[e.type]);return}console.log("Unknown error:",e),o("Unknown error, please try again.")}})]}):(0,n.jsx)(j,{token:t,onLogout:()=>{i(null),o(void 0)}})})}},5614:(e,o,t)=>{"use strict";t.d(o,{A:()=>n});let n=t(9693).default},8648:(e,o,t)=>{"use strict";t.d(o,{w:()=>n});let n=t(9142).y},8726:(e,o,t)=>{"use strict";t.d(o,{default:()=>g});var n=t(4568),r=t(5614),a=t(1321),s=t(9515),i=t(7620),l=t(8648),c=t(7187);let d=["Home","Blog","Portfolio","About","Contact"],u=()=>(0,n.jsx)(a.default,{direction:"row",spacing:l.w.spacing(2),children:d.map(e=>(0,n.jsx)(r.A,{children:e},e))}),p=()=>{let[e,o]=(0,i.useState)(!1),t=()=>(0,n.jsx)(s.A,{sx:{"&:hover":{cursor:"pointer"}},onClick:()=>{o(!e)}});return(0,n.jsx)(a.default,{children:(0,n.jsxs)(a.default,{position:"relative",padding:2,children:[(0,n.jsx)(t,{}),(0,n.jsxs)(a.default,{position:"absolute",alignItems:"flex-end",direction:"column",top:-2,right:-2,padding:2,sx:{backgroundColor:"white",boxShadow:e?"0px 8px 12px rgba(0, 0, 0, 0.2)":void 0},children:[(0,n.jsx)(t,{}),e&&(0,n.jsx)(n.Fragment,{children:d.map(e=>(0,n.jsx)(a.default,{padding:1,children:(0,n.jsx)(r.A,{children:e})},e))})]})]})})},g=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.default,{sx:e=>({display:"none",[e.breakpoints.up("md")]:{display:"block"}}),children:(0,n.jsx)(u,{})}),(0,n.jsx)(c.default,{sx:e=>({display:"none",[e.breakpoints.down("md")]:{display:"block"}}),children:(0,n.jsx)(p,{})})]})},9142:(e,o,t)=>{"use strict";t.d(o,{y:()=>n});let n={spacing:e=>"".concat(.5*e,"rem"),breakpoints:{values:{xs:340,sm:600,md:900,lg:1200,xl:1536}},components:{MuiUseMediaQuery:{defaultProps:{noSsr:!0}}},typography:{fontFamily:"var(--font-roboto)"}}},9374:(e,o,t)=>{Promise.resolve().then(t.bind(t,7187)),Promise.resolve().then(t.bind(t,5220)),Promise.resolve().then(t.bind(t,1321)),Promise.resolve().then(t.bind(t,9693)),Promise.resolve().then(t.t.bind(t,9664,23)),Promise.resolve().then(t.bind(t,4464)),Promise.resolve().then(t.bind(t,8726))}},e=>{e.O(0,[442,160,784,587,18,358],()=>e(e.s=9374)),_N_E=e.O()}]);